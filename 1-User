-- MT BIG UPDATE ‚Ä¢ FINAL (X2ZU) ‚Äî VIP Multi-User System (with Expiry Date, Original UI)
repeat wait() until game:IsLoaded()

-- Services & player
local Players = game:GetService("Players")
local plr = Players.LocalPlayer or Players.PlayerAdded:Wait()

-- =========================
-- VIP SYSTEM: multiple usernames + custom duration (days)
-- =========================
-- Format: ["Username"] = days
local VIP_LIST = {
    ["LlyXCode"] = 999,
    ["lylyyyoz4"] = 999,
    ["FAYINTX"] = 999,
  	["ferryherpiman"] = 29,
  	["kiki_xo17"] = 30,
}

-- helper notify
local function notify_local(title, text, dur)
    pcall(function()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = title,
            Text = text,
            Duration = dur or 4
        })
    end)
end

-- Cari username di list (case-insensitive)
local function find_vip_entry(name)
    for uname, days in pairs(VIP_LIST) do
        if string.lower(uname) == string.lower(name) then
            return uname, days
        end
    end
    return nil, nil
end

local vipName, vipDays = find_vip_entry(plr.Name or "")
if not vipName then
    notify_local("LlyXCode Script", "Kamu bukan VIP! Script dihentikan.", 5)
    return
end

-- =========================
-- SISTEM PENYIMPANAN AKTIVASI
-- =========================
local function get_or_create_vip_start(player, vipKey)
    local container = player:FindFirstChild("PlayerScripts") or player:FindFirstChild("PlayerGui") or player
    if not container then return nil end

    local keyName = vipKey .. "_VIP_START"
    local existing = container:FindFirstChild(keyName)
    if existing and existing:IsA("NumberValue") then
        return existing
    end

    local nv = Instance.new("NumberValue")
    nv.Name = keyName
    nv.Value = 0
    nv.Parent = container
    return nv
end

local vipKey = string.gsub(vipName, "%s+", "_")
local vipStartVal = get_or_create_vip_start(plr, vipKey)
if not vipStartVal then
    notify_local("LlyXCode Script", "Gagal inisialisasi VIP data. Script dihentikan.", 5)
    return
end

-- set start time jika belum ada
if vipStartVal.Value == 0 then
    vipStartVal.Value = os.time()
end

-- hitung durasi & tanggal kadaluarsa
local currentTime = os.time()
local startTime = vipStartVal.Value or currentTime
local trialDuration = vipDays * 24 * 60 * 60
local expireTime = startTime + trialDuration

if currentTime > expireTime then
    notify_local("LlyXCode Script", "VIP expired ("..vipName..", "..vipDays.." hari).", 5)
    return
end

-- hitung sisa hari & format tanggal
local remainingDays = math.ceil((expireTime - currentTime) / 86400)
local expireDate = os.date("%d %b %Y", expireTime)

-- sukses
notify_local(
    "LlyXCode Script",
    "Selamat datang VIP: "..plr.Name..
    "\nExpired dalam "..remainingDays.." hari (üìÖ "..expireDate..")",
    6
)

-- =========================
-- LANJUTKAN SCRIPT (UI ASLI)
-- =========================

-- Services & other refs
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Load X2ZU UI Library (external) ‚Äî hanya dipanggil setelah VIP-check
local Library = nil
pcall(function()
    Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/x2zu/OPEN-SOURCE-UI-ROBLOX/refs/heads/main/X2ZU%20UI%20ROBLOX%20OPEN%20SOURCE/DummyUi-leak-by-x2zu/fetching-main/Tools/Framework.luau"))()
end)
if not Library then
    notify_local("LlyXCode Script", "Gagal load UI library (beberapa fitur mungkin error).", 5)
end

-- Window (TIDAK DIUBAH)
local Window = nil
if Library and Library.Window then
    Window = Library:Window({
        Title = "LlyXCode All Mount V2.3",
        Desc = "CRCK LlyXCode",
        Icon = 105059922903197,
        Theme = "Dark",
        Config = { Keybind = Enum.KeyCode.LeftControl, Size = UDim2.new(0,430,0,300) },
        CloseUIButton = { Enabled = true, Text = "LlyXCode „Ä¢ VIP" }
    })
else
    -- dummy table biar aman
    Window = {
        Tab = function(_) return {
            Button = function(_) end,
            Toggle = function(_) end,
            Slider = function(_) end,
            Textbox = function(_) end,
            Label = function(_) end
        } end
    }
end

-- Helper notify (library-aware)
local function notify(title, text, dur)
    pcall(function()
        if Library and Library.Notification then
            Library:Notification(title .. " ‚Äî " .. text, dur or 3)
        else
            pcall(function()
                game:GetService("StarterGui"):SetCore("SendNotification", {Title = title, Text = text, Duration = dur or 3})
            end)
        end
    end)
end

-- =========================
-- Helper: getHumanoid
-- =========================
local function getHumanoid()
    local c = plr.Character
    if not c then return nil end
    return c:FindFirstChildOfClass("Humanoid")
end

-- =========================
-- TAB: Gunung
-- =========================
local GunungTab = Window:Tab({Title="‚õ∞Ô∏è Gunung", Icon="mountain"})

-- Daftar 10 gunung 
local gunungLinks = {
    ["MT YUKARI"] = "https://raw.githubusercontent.com/LlyXCode-gif/1-DAY-LlyXCode/refs/heads/main/MT%20YUKARI",
    ["MT SUGOI"] = "https://pastefy.app/zgV1XYvk/raw",
    ["MT PEDAUNAN"] = "https://pastefy.app/FKbwCb5u/raw",
    ["MT KAWAII"] = "https://pastefy.app/QBMrtKBP/raw",
    ["MT BINGUNG"] = "https://pastefy.app/0AhMfOrt/raw",
    ["PUNCAK MIMPI"] = "https://raw.githubusercontent.com/LlyXCode-gif/1-DAY-LlyXCode/refs/heads/main/PUNCAK%20MIMPI",
    ["MT MONO"] = "https://raw.githubusercontent.com/LlyXCode-gif/1-DAY-LlyXCode/refs/heads/main/MT%20MONO",
    ["HELL EXPEDISION"] = "https://pastefy.app/M2HpFaaF/raw",
    ["MT QIAN"] = "https://pastefy.app/WTPJy2RX/raw",
    ["MT SUMBING"] = "https://pastefy.app/K1bLyNmW/raw",
    ["MT ATIN"] = "https://pastefy.app/57vX1BC1/raw",
    ["MT Wayang"] = "https://pastefy.app/8K5KBoUZ/raw",
    ["MT CHIBI"] = "https://raw.githubusercontent.com/LlyXCode-gif/1-DAY-LlyXCode/refs/heads/main/MT%20CHIBI",
}

-- Buat tombol untuk tiap gunung
for nama, url in pairs(gunungLinks) do
    GunungTab:Button({
        Title = nama,
        Callback = function()
            notify("LlyXCode", "Loading " .. nama .. "...", 2)
            pcall(function()
                loadstring(game:HttpGet(url))()
            end)
        end
    })
end

-- =========================
-- TAB: Cheat
-- =========================
local CheatTab = Window:Tab({Title="‚ö° Cheat", Icon="zap"})
local state = {
    god=false, noclip=false, esp=false, invis=false, autoheal=false, infjump=false, antiFall=false,
    flyExternal=false, flyScriptUrl = "https://pastefy.app/sGRhOyN2/raw", teleTarget=""
}

-- connections
local conn_noclip, conn_esp_added, conn_infjump = nil, nil, nil
local esp_table = {}

-- GOD MODE: persistent across respawns
local function applyGod()
    local h = getHumanoid()
    if h then h.Health = h.MaxHealth end
end
local godLoop
CheatTab:Toggle({
    Title = "üí™ God Mode",
    Value = false,
    Callback = function(v)
        state.god = v
        if v then
            applyGod()
            godLoop = task.spawn(function()
                while state.god do
                    applyGod()
                    task.wait(0.6)
                end
            end)
            notify("God Mode", "ON", 2)
        else
            state.god = false
            notify("God Mode", "OFF", 2)
        end
    end
})
-- reapply on respawn
plr.CharacterAdded:Connect(function()
    task.wait(0.5)
    if state.god then applyGod() end
end)

-- NOCLIP
CheatTab:Toggle({
    Title = "üí® Noclip",
    Value = false,
    Callback = function(v)
        state.noclip = v
        if v then
            conn_noclip = RunService.Stepped:Connect(function()
                local c = plr.Character
                if c then
                    for _, part in pairs(c:GetDescendants()) do
                        if part:IsA("BasePart") then
                            pcall(function() part.CanCollide = false end)
                        end
                    end
                end
            end)
            notify("Noclip", "ON", 2)
        else
            if conn_noclip then conn_noclip:Disconnect() conn_noclip = nil end
            notify("Noclip", "OFF", 2)
        end
    end
})

-- FLY (external): toggle calls external loadstring when turned ON (does NOT stop on OFF)
CheatTab:Toggle({
    Title = "üïäÔ∏è Fly",
    Value = false,
    Callback = function(v)
        state.flyExternal = v
        if v then
            notify("Fly", "Loading external fly script...", 2)
            pcall(function()
                loadstring(game:HttpGet(state.flyScriptUrl))()
            end)
            notify("Fly", "External script called (ON). Toggle OFF does not stop it.", 3)
        else
            notify("Fly", "OFF (external script not forcibly stopped)", 2)
        end
    end
})

-- SPEED BOOST & JUMP POWER
CheatTab:Slider({
    Title = "üèÉ Speed Boost",
    Min = 16, Max = 300, Value = 16,
    Callback = function(v)
        local h = getHumanoid()
        if h then h.WalkSpeed = v end
    end
})
CheatTab:Slider({
    Title = "ü¶ò Jump Power",
    Min = 50, Max = 500, Value = 50,
    Callback = function(v)
        local h = getHumanoid()
        if h then h.JumpPower = v end
    end
})

-- ANTI FALL
CheatTab:Toggle({
    Title = "ü™∂ Anti Fall",
    Value = false,
    Callback = function(v)
        state.antiFall = v
        local h = getHumanoid()
        if h then h:SetStateEnabled(Enum.HumanoidStateType.Freefall, not v) end
        notify("Anti Fall", v and "ON" or "OFF", 2)
    end
})

-- ESP (Highlight)
CheatTab:Toggle({
    Title = "üéØ ESP (Player Highlight)",
    Value = false,
    Callback = function(v)
        state.esp = v
        if v then
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= plr and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local hl = p.Character:FindFirstChildOfClass("Highlight")
                    if not hl then hl = Instance.new("Highlight", p.Character) end
                    hl.Name = "MT_ESP"; hl.FillTransparency = 0.7; hl.OutlineColor = Color3.fromRGB(255,90,170); hl.Enabled = true
                    esp_table[p] = hl
                end
            end
            if not conn_esp_added then
                conn_esp_added = Players.PlayerAdded:Connect(function(p)
                    task.wait(0.5)
                    if state.esp and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                        local hl = p.Character:FindFirstChildOfClass("Highlight") or Instance.new("Highlight", p.Character)
                        hl.Name = "MT_ESP"; hl.FillTransparency = 1; hl.OutlineColor = Color3.fromRGB(255,90,170); hl.Enabled = true
                        esp_table[p] = hl
                    end
                end)
            end
            notify("ESP", "ON", 2)
        else
            for p, hl in pairs(esp_table) do pcall(function() hl:Destroy() end) end
            esp_table = {}
            if conn_esp_added then conn_esp_added:Disconnect() conn_esp_added = nil end
            notify("ESP", "OFF", 2)
        end
    end
})

-- INVISIBILITY (local only)
CheatTab:Toggle({
    Title = "üëª Invisibility",
    Value = false,
    Callback = function(v)
        state.invis = v
        local c = plr.Character
        if c then
            for _, obj in pairs(c:GetDescendants()) do
                if obj:IsA("BasePart") then pcall(function() obj.Transparency = v and 1 or 0 end) end
                if obj:IsA("Decal") or obj:IsA("Texture") then pcall(function() obj.Transparency = v and 1 or 0 end) end
            end
        end
        notify("Invisibility", v and "ON" or "OFF", 2)
    end
})

-- AUTO HEAL (gradual)
CheatTab:Toggle({
    Title = "üíâ Auto Heal",
    Value = false,
    Callback = function(v)
        state.autoheal = v
        if v then
            task.spawn(function()
                while state.autoheal do
                    local h = getHumanoid()
                    if h and h.Health < h.MaxHealth then
                        h.Health = math.min(h.MaxHealth, h.Health + math.max(1, math.floor(h.MaxHealth * 0.05)))
                    end
                    task.wait(1)
                end
            end)
            notify("Auto Heal", "ON", 2)
        else
            notify("Auto Heal", "OFF", 2)
        end
    end
})

-- INFINITE JUMP
CheatTab:Toggle({
    Title = "üöÄ Infinite Jump",
    Value = false,
    Callback = function(v)
        state.infjump = v
        if v then
            conn_infjump = UserInputService.JumpRequest:Connect(function()
                local h = getHumanoid()
                if h then h:ChangeState(Enum.HumanoidStateType.Jumping) end
            end)
            notify("Infinite Jump", "ON", 2)
        else
            if conn_infjump then conn_infjump:Disconnect() conn_infjump = nil end
            notify("Infinite Jump", "OFF", 2)
        end
    end
})

-- TELEPORT TO PLAYER
CheatTab:Textbox({
    Title = "Teleport to Player",
    Text = "",
    Callback = function(txt) state.teleTarget = txt end
})
CheatTab:Button({
    Title = "Teleport",
    Callback = function()
        local name = state.teleTarget
        if not name or name == "" then notify("Teleport", "Masukkan username dulu", 2); return end
        local t = Players:FindFirstChild(name)
        if t and t.Character and t.Character:FindFirstChild("HumanoidRootPart") then
            -- safeTeleport unspecified in original; try basic set CFrame of HumanoidRootPart
            pcall(function()
                local hrp = plr.Character and plr.Character:FindFirstChild("HumanoidRootPart")
                if hrp and t.Character and t.Character:FindFirstChild("HumanoidRootPart") then
                    hrp.CFrame = t.Character.HumanoidRootPart.CFrame + Vector3.new(0,3,0)
                end
            end)
            notify("Teleport", "Berhasil ke "..name, 2)
        else
            notify("Teleport", "Salah Masukin Nama, Hadehh", 2)
        end
    end
})

-- === TAB PRIVATE SERVER (INLINE) ===
do
    local PSTab = Window:Tab({Title = "Private Server", Icon = "server"})
    local psActiveLabel = PSTab:Label({ Title = "Private Server: 5 Detik" })
    local psRunning = false

    -- Bungkus seluruh private server code ke dalam fungsi supaya inline
    local function startPrivateServer()
        -- Jika sudah aktif, lewat
        if psRunning then return end
        psRunning = true
        pcall(function()
            -- === BEGIN inlined private-server code ===
            -- Script by LlyXCode -- PRIVATE SERVER CREATOR
            local md5 = {}
            local hmac = {}
            local base64 = {}
            do
                do
                    local T = {
                        0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee, 0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501,
                        0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be, 0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821,
                        0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa, 0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8,
                        0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed, 0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a,
                        0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c, 0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70,
                        0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05, 0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665,
                        0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039, 0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1,
                        0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1, 0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391,
                    }
                    local function add(a, b)
                        local lsw = bit32.band(a, 0xFFFF) + bit32.band(b, 0xFFFF)
                        local msw = bit32.rshift(a, 16) + bit32.rshift(b, 16) + bit32.rshift(lsw, 16)
                        return bit32.bor(bit32.lshift(msw, 16), bit32.band(lsw, 0xFFFF))
                    end
                    local function rol(x, n) return bit32.bor(bit32.lshift(x, n), bit32.rshift(x, 32 - n)) end
                    local function F(x, y, z) return bit32.bor(bit32.band(x, y), bit32.band(bit32.bnot(x), z)) end
                    local function G(x, y, z) return bit32.bor(bit32.band(x, z), bit32.band(y, bit32.bnot(z))) end
                    local function H(x, y, z) return bit32.bxor(x, bit32.bxor(y, z)) end
                    local function I(x, y, z) return bit32.bxor(y, bit32.bor(x, bit32.bnot(z))) end

                    function md5.sum(message)
                        local a, b, c, d = 0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476
                        local message_len = #message
                        local padded_message = message .. "\128"
                        while #padded_message % 64 ~= 56 do padded_message = padded_message .. "\0" end
                        local len_bytes = ""
                        local len_bits = message_len * 8
                        for i = 0, 7 do
                            len_bytes = len_bytes .. string.char(bit32.band(bit32.rshift(len_bits, i * 8), 0xFF))
                        end
                        padded_message = padded_message .. len_bytes
                        for i = 1, #padded_message, 64 do
                            local chunk = padded_message:sub(i, i + 63)
                            local X = {}
                            for j = 0, 15 do
                                local b1, b2, b3, b4 = chunk:byte(j * 4 + 1, j * 4 + 4)
                                X[j] = bit32.bor(b1, bit32.lshift(b2, 8), bit32.lshift(b3, 16), bit32.lshift(b4, 24))
                            end
                            local aa, bb, cc, dd = a, b, c, d
                            local s = { 7, 12, 17, 22, 5, 9, 14, 20, 4, 11, 16, 23, 6, 10, 15, 21 }
                            for j = 0, 63 do
                                local f, k, shift_index
                                if j < 16 then
                                    f = F(b, c, d) k = j shift_index = j % 4
                                elseif j < 32 then
                                    f = G(b, c, d) k = (1 + 5 * j) % 16 shift_index = 4 + (j % 4)
                                elseif j < 48 then
                                    f = H(b, c, d) k = (5 + 3 * j) % 16 shift_index = 8 + (j % 4)
                                else
                                    f = I(b, c, d) k = (7 * j) % 16 shift_index = 12 + (j % 4)
                                end
                                local temp = add(a, f)
                                temp = add(temp, X[k])
                                temp = add(temp, T[j + 1])
                                temp = rol(temp, s[shift_index + 1])
                                local new_b = add(b, temp)
                                a, b, c, d = d, new_b, b, c
                            end
                            a = add(a, aa) b = add(b, bb) c = add(c, cc) d = add(d, dd)
                        end
                        local function to_le_hex(n)
                            local s = ""
                            for i = 0, 3 do s = s .. string.char(bit32.band(bit32.rshift(n, i * 8), 0xFF)) end
                            return s
                        end
                        return to_le_hex(a) .. to_le_hex(b) .. to_le_hex(c) .. to_le_hex(d)
                    end
                end

                do
                    function hmac.new(key, msg, hash_func)
                        if #key > 64 then key = hash_func(key) end
                        local o_key_pad = "" local i_key_pad = ""
                        for i = 1, 64 do
                            local byte = (i <= #key and string.byte(key, i)) or 0
                            o_key_pad = o_key_pad .. string.char(bit32.bxor(byte, 0x5C))
                            i_key_pad = i_key_pad .. string.char(bit32.bxor(byte, 0x36))
                        end
                        return hash_func(o_key_pad .. hash_func(i_key_pad .. msg))
                    end
                end

                do
                    local b = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
                    function base64.encode(data)
                        return ( (data:gsub(".", function(x)
                            local r, b_val = "", x:byte()
                            for i = 8, 1, -1 do r = r .. (b_val % 2 ^ i - b_val % 2 ^ (i - 1) > 0 and "1" or "0") end
                            return r
                        end) .. "0000"):gsub("%d%d%d?%d?%d?%d?", function(x)
                            if #x < 6 then return "" end
                            local c = 0
                            for i = 1, 6 do c = c + (x:sub(i, i) == "1" and 2 ^ (6 - i) or 0) end
                            return b:sub(c + 1, c + 1)
                        end) .. ({ "", "==", "=" })[#data % 3 + 1] )
                    end
                end
            end

            local function GenerateReservedServerCode(placeId)
                local uuid = {}
                for i = 1, 16 do uuid[i] = math.random(0, 255) end
                uuid[7] = bit32.bor(bit32.band(uuid[7], 0x0F), 0x40) -- v4 uuid
                uuid[9] = bit32.bor(bit32.band(uuid[9], 0x3F), 0x80) -- RFC 4122
                local firstBytes = ""
                for i = 1, 16 do firstBytes = firstBytes .. string.char(uuid[i]) end
                local gameCode = string.format("%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x", table.unpack(uuid))
                local placeIdBytes = ""
                local pIdRec = placeId
                for _ = 1, 8 do
                    placeIdBytes = placeIdBytes .. string.char(pIdRec % 256)
                    pIdRec = math.floor(pIdRec / 256)
                end
                local content = firstBytes .. placeIdBytes
                local SUPERDUPERSECRETROBLOXKEYTHATTHEYDIDNTCHANGEEVERSINCEFOREVER = "e4Yn8ckbCJtw2sv7qmbg" -- legacy leaked key
                local signature = hmac.new(SUPERDUPERSECRETROBLOXKEYTHATTHEYDIDNTCHANGEEVERSINCEFOREVER, content, md5.sum)
                local accessCodeBytes = signature .. content
                local accessCode = base64.encode(accessCodeBytes)
                accessCode = accessCode:gsub("+", "-"):gsub("/", "_")
                local pdding = 0
                accessCode, _ = accessCode:gsub("=", function() pdding = pdding + 1 return "" end)
                accessCode = accessCode .. tostring(pdding)
                return accessCode, gameCode
            end

            local accessCode, _ = GenerateReservedServerCode(game.PlaceId)
            -- Fire server attempt to create/join reserved server
            pcall(function()
                game.RobloxReplicatedStorage.ContactListIrisInviteTeleport:FireServer(game.PlaceId, "", accessCode)
            end)
            -- copy to clipboard (if environment supports)
            pcall(function() setclipboard(accessCode) end)
            -- === END inlined private-server code ===
        end)

        -- update label
        pcall(function() psActiveLabel:Set("Private Server: ON") end)
    end

    -- If user wants to "turn off" PS, we only set flag (most PS code can't be fully unloaded).
    local function stopPrivateServer()
        psRunning = false
        pcall(function() psActiveLabel:Set("Private Server: OFF") end)
        -- no guaranteed cleanup: add custom cleanup inside PS code if perlu
    end

    -- Toggle pada UI
    PSTab:Toggle({
        Title = "Enable Private Server",
        Value = false,
        Callback = function(state)
            if state then
                startPrivateServer()
            else
                stopPrivateServer()
            end
        end
    })
end

-- =========================
-- TAB: LlyXCode Sparkles (Animasi)
-- =========================
local SparklesTab = Window:Tab({Title="üåüEfek", Icon="sparkles"})

-- Helper references
local player = game.Players.LocalPlayer
local bodyParts = {"HumanoidRootPart", "Head","LeftHand","RightHand","LeftFoot","RightFoot"}

local currentMode = nil
local activeMode = nil
local animating = false
local buttons = {}

-- Functions
local function applySparkles(character)
    local sparklesList = {}
    for _, partName in ipairs(bodyParts) do
        local part = character:FindFirstChild(partName)
        if part then
            local spark = part:FindFirstChild("Sparkles")
            if not spark then
                spark = Instance.new("Sparkles")
                spark.Parent = part
            end
            table.insert(sparklesList, spark)
        end
    end
    return sparklesList
end

local function removeSparkles(character)
    for _, partName in ipairs(bodyParts) do
        local part = character:FindFirstChild(partName)
        if part then
            local spark = part:FindFirstChild("Sparkles")
            if spark then spark:Destroy() end
        end
    end
end

local function startAnimation(mode, sparklesList)
    currentMode = mode
    animating = true

    task.spawn(function()
        local t = 0
        while animating and currentMode == mode and #sparklesList > 0 do
            t += 0.15
            for _, s in ipairs(sparklesList) do
                if mode == "DISCO" then
                    local r = math.sin(t)*127+128
                    local g = math.sin(t+2)*127+128
                    local b = math.sin(t+4)*127+128
                    s.SparkleColor = Color3.fromRGB(r,g,b)
                elseif mode == "PURPLE" then s.SparkleColor = Color3.fromRGB(160,32,240)
                elseif mode == "CYAN" then s.SparkleColor = Color3.fromRGB(0,200,255)
                elseif mode == "RED" then s.SparkleColor = Color3.fromRGB(255,0,0)
                elseif mode == "GREEN" then s.SparkleColor = Color3.fromRGB(0,255,0)
                elseif mode == "YELLOW" then s.SparkleColor = Color3.fromRGB(255,255,0)
                elseif mode == "ORANGE" then s.SparkleColor = Color3.fromRGB(255,140,0)
                elseif mode == "PINK" then s.SparkleColor = Color3.fromRGB(255,105,180)
                elseif mode == "WHITE" then s.SparkleColor = Color3.fromRGB(255,255,255)
                elseif mode == "BLACK" then s.SparkleColor = Color3.fromRGB(30,30,30)
                elseif mode == "RAINBOW" then s.SparkleColor = Color3.fromHSV((t%6)/6,1,1)
                elseif mode == "OCEAN" then s.SparkleColor = Color3.fromRGB(0,100,255)
                elseif mode == "GOLD" then s.SparkleColor = Color3.fromRGB(255,215,0)
                elseif mode == "SILVER" then s.SparkleColor = Color3.fromRGB(192,192,192)
                elseif mode == "MAGENTA" then s.SparkleColor = Color3.fromRGB(255,0,255)
                end
            end
            task.wait(0.1)
        end
    end)
end

-- Add buttons
local function addFeature(name, mode)
    local btn = SparklesTab:Button({
        Title = name,
        Callback = function()
            local char = player.Character or player.CharacterAdded:Wait()

            if activeMode == mode then
                animating = false
                activeMode = nil
                currentMode = nil
                removeSparkles(char)
                return
            end

            animating = false
            removeSparkles(char)
            local sparklesList = applySparkles(char)
            startAnimation(mode, sparklesList)
            activeMode = mode
        end
    })
    buttons[mode] = btn
end

-- Semua animasi
local anims = {
    {"‚ú® DISCO ‚ú®","DISCO"},{"üíú PURPLE üíú","PURPLE"},{"üåä CYAN üåä","CYAN"},{"‚ù§Ô∏è RED ‚ù§Ô∏è","RED"},
    {"üíö GREEN üíö","GREEN"},{"üíõ YELLOW üíõ","YELLOW"},{"üü† ORANGE üü†","ORANGE"},{"üíñ PINK üíñ","PINK"},
    {"‚ö™ WHITE ‚ö™","WHITE"},{"‚ö´ BLACK ‚ö´","BLACK"},{"üåà RAINBOW üåà","RAINBOW"},{"üåä OCEAN üåä","OCEAN"},
    {"üèÜ GOLD üèÜ","GOLD"},{"ü•à SILVER ü•à","SILVER"},{"üíü MAGENTA üíü","MAGENTA"}
}

for _, v in ipairs(anims) do
    addFeature(v[1], v[2])
end

-- Auto reapply saat respawn
player.CharacterAdded:Connect(function(char)
    if currentMode then
        task.wait(1)
        local sparklesList = applySparkles(char)
        startAnimation(currentMode, sparklesList)
    else
        task.wait(1)
        removeSparkles(char)
    end
end)

-- =========================
-- Titles Tab
-- =========================
local TitleTab = Window:Tab({Title="üè∑Ô∏è Titles", Icon="tag"})

local currentTitle = nil
local currentBillboard = nil

local function applyTitle(titleText)
    local char = plr.Character or plr.CharacterAdded:Wait()
    local head = char:WaitForChild("Head")

    if currentBillboard then
        currentBillboard:Destroy()
        currentBillboard = nil
    end

    if not titleText then
        currentTitle = nil
        return
    end

    currentTitle = titleText

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "AdminTag"
    billboard.Parent = head
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 2.7, 0)
    billboard.AlwaysOnTop = true
    billboard.LightInfluence = 0
    currentBillboard = billboard

    local text = Instance.new("TextLabel")
    text.Parent = billboard
    text.Size = UDim2.new(1, 0, 1, 0)
    text.BackgroundTransparency = 1
    text.Text = titleText
    text.Font = Enum.Font.SourceSansBold
    text.TextSize = 18
    text.TextStrokeTransparency = 0

    local t = 0
    task.spawn(function()
        while billboard.Parent do
            t += 0.15
            local r = math.floor(math.sin(t*2) * 127 + 128)
            local g = math.floor(math.sin(t*2 + 2) * 127 + 128)
            local b = math.floor(math.sin(t*2 + 4) * 127 + 128)
            text.TextColor3 = Color3.fromRGB(r, g, b)
            task.wait(0.1)
        end
    end)
end

plr.CharacterAdded:Connect(function()
    if currentTitle then
        task.wait(1)
        applyTitle(currentTitle)
    end
end)

local titles = {
    "üõ† DEVELOPER Ô∏èüõ†","üëë OWNER üëë","üõ°Ô∏è Team „Ä¢ XCode üõ°Ô∏è","üõ°Ô∏è ADMIN üõ°Ô∏è",
    "üíé VIP üíé","üèÜ TOP DONATUR üèÜ","üíñ SUPER VIP üíñ","üî• ELITE üî•",
    "üåü LEGEND üåü","‚ö° PRO ‚ö°","üèÖ CHAMPION üèÖ","üëë LEGENDARY üëë","üåå TOLOLLL üåå"
}

local buttons = {}
for _,titleText in ipairs(titles) do
    local btn = TitleTab:Button({
        Title = titleText,
        Callback = function()
            if currentTitle == titleText then
                applyTitle(nil)
            else
                applyTitle(titleText)
            end
        end
    })
    buttons[titleText] = btn
end

-- =========================
-- TAB: Animasi Jalan Loncat Dll
-- =========================
local AnimasiTab = Window:Tab({Title = "üåüAnimasi", Icon = "sparkles"})

local AnimasiURL = "https://pastefy.app/N5NUhiq5/raw"
local AnimasiRunning = false
local AnimasiThread

AnimasiTab:Toggle({
    Title = "üíÉ Aktifkan Animasi",
    Value = false,
    Callback = function(state)
        if state then
            -- Saat toggle ON
            AnimasiRunning = true
            task.spawn(function()
                local ok, content = pcall(function()
                    return game:HttpGet(AnimasiURL)
                end)
                if ok and content and content ~= "" then
                    local func = loadstring(content)
                    if func then
                        local success, err = pcall(func)
                        if not success then
                            warn("Animasi error:", err)
                        end
                    else
                        warn("Gagal compile script animasi.")
                    end
                else
                    warn("Gagal ambil script animasi.")
                end
            end)
        else
            -- Saat toggle OFF
            AnimasiRunning = false
            -- (Kalau script animasimu punya fungsi stop, panggil di sini)
            print("Animasi dimatikan.")
        end
    end
})

-- =========================
-- TAB: Credits
-- =========================
local CreditsTab = Window:Tab({Title="Credits", Icon="star"})
CreditsTab:Label({Title="üìÑ Script: ALL MOUNT"})
CreditsTab:Label({Title="üëë Author: LlyXCode"})
CreditsTab:Label({Title="üî• UPDATE KALO VIP DOANG"})
CreditsTab:Label({Title="‚õ∞Ô∏è REQ GN ?..."})
CreditsTab:Label({ Title = "üí∏ Support Developer with üíï" })

-- =========================
-- TAB: Log Update
-- =========================
local CreditsTab = Window:Tab({Title="Log Update", Icon="list"})
CreditsTab:Label({Title="üìÑ FIXED CP MT PEDAUNAN"})
CreditsTab:Label({Title="‚Ä¢ HAPUS TRIAL YAHAYUK"})
-- End of script
